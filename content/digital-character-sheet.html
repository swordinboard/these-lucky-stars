<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>These Lucky Stars - Digital Character Sheet</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.5;
            color: #374151;
            background-color: #f9fafb;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            background: white;
        }
        
        .header {
            background: #1e3a8a;
            color: white;
            padding: 1rem;
            border-radius: 0.5rem 0.5rem 0 0;
            text-align: center;
        }
        
        .controls {
            background: #f3f4f6;
            padding: 1rem;
            border-left: 1px solid #d1d5db;
            border-right: 1px solid #d1d5db;
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .btn-blue { background: #2563eb; color: white; }
        .btn-blue:hover { background: #1d4ed8; }
        .btn-green { background: #16a34a; color: white; }
        .btn-green:hover { background: #15803d; }
        .btn-purple { background: #9333ea; color: white; }
        .btn-purple:hover { background: #7c3aed; }
        
        .tabs {
            background: #f9fafb;
            padding: 1rem;
            border-left: 1px solid #d1d5db;
            border-right: 1px solid #d1d5db;
        }
        
        .tab-buttons {
            display: flex;
            gap: 0.25rem;
        }
        
        .tab-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem 0.5rem 0 0;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .tab-btn.active {
            background: #1e3a8a;
            color: white;
            border-bottom: 2px solid #1e3a8a;
        }
        
        .tab-btn:not(.active) {
            background: #e5e7eb;
            color: #374151;
        }
        
        .tab-btn:not(.active):hover {
            background: #d1d5db;
        }
        
        .content {
            border: 1px solid #d1d5db;
            border-top: none;
            border-radius: 0 0 0.5rem 0.5rem;
            padding: 1.5rem;
        }
        
        .grid {
            display: grid;
            gap: 1rem;
        }
        
        .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
        .grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
        .grid-cols-4 { grid-template-columns: repeat(4, 1fr); }
        .grid-cols-5 { grid-template-columns: repeat(5, 1fr); }
        .grid-cols-12 { grid-template-columns: repeat(12, 1fr); }
        
        @media (max-width: 768px) {
            .grid-cols-4 { grid-template-columns: repeat(2, 1fr); }
            .grid-cols-5 { grid-template-columns: repeat(2, 1fr); }
            .grid-cols-12 { grid-template-columns: 1fr; }
        }
        
        .input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 0.875rem;
        }
        
        .input:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .textarea {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            resize: vertical;
            font-family: inherit;
        }
        
        .select {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            background: white;
        }
        
        .label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.25rem;
            font-size: 0.875rem;
        }
        
        .label-sm {
            font-size: 0.75rem;
            color: #6b7280;
        }
        
        .stat-block {
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            text-align: center;
        }
        
        .stat-yellow { background: #fefce8; }
        .stat-green { background: #f0fdf4; }
        .stat-blue { background: #eff6ff; }
        .stat-red { background: #fef2f2; }
        .stat-purple { background: #faf5ff; }
        .stat-orange { background: #fff7ed; }
        .stat-indigo { background: #eef2ff; }
        .stat-gray { background: #f9fafb; }
        
        .stat-value {
            font-size: 1.125rem;
            font-weight: 700;
            margin: 0.25rem 0;
        }
        
        .stat-label {
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .stat-desc {
            font-size: 0.75rem;
            color: #6b7280;
        }
        
        .attr-block {
            background: #f9fafb;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
        }
        
        .attr-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .attr-inputs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .attr-total {
            text-align: center;
            font-size: 1.125rem;
            font-weight: 700;
            color: #1e40af;
        }
        
        .equipment-block {
            background: #f9fafb;
            padding: 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .section-title {
            font-size: 1.125rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .hidden { display: none; }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
        }
        
        .modal-content {
            background: white;
            border-radius: 0.5rem;
            padding: 1.5rem;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .modal-title {
            font-size: 1.25rem;
            font-weight: 700;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6b7280;
            margin-left: auto;
        }
        
        .close-btn:hover {
            color: #374151;
        }
        
        .space-y-4 > * + * { margin-top: 1rem; }
        .space-y-3 > * + * { margin-top: 0.75rem; }
        .space-y-2 > * + * { margin-top: 0.5rem; }
        .space-y-1 > * + * { margin-top: 0.25rem; }
        
        .mb-1 { margin-bottom: 0.25rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-3 { margin-bottom: 0.75rem; }
        .mb-4 { margin-bottom: 1rem; }
        
        .text-center { text-align: center; }
        .text-sm { font-size: 0.875rem; }
        .text-xs { font-size: 0.75rem; }
        .font-bold { font-weight: 700; }
        .font-semibold { font-weight: 600; }
        
        .col-span-2 { grid-column: span 2; }
        .col-span-8 { grid-column: span 8; }
        
        .flex { display: flex; }
        .flex-1 { flex: 1; }
        .gap-2 { gap: 0.5rem; }
        .items-center { align-items: center; }
        .justify-end { justify-content: flex-end; }
        
        @media (max-width: 768px) {
            .container { padding: 0.5rem; }
            .content { padding: 1rem; }
            .controls { flex-direction: column; align-items: center; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>These Lucky Stars v.4.25 - Digital Character Sheet</h1>
        </div>

        <!-- Controls -->
        <div class="controls">
            <button class="btn btn-blue" onclick="saveCharacter()">
                üíæ Save Sheet
            </button>
            <button class="btn btn-green" onclick="document.getElementById('fileInput').click()">
                üìÅ Load Sheet
            </button>
            <button class="btn btn-purple" onclick="showHelp()">
                ‚ùì How To Use
            </button>
            <input type="file" id="fileInput" accept=".json" style="display: none;" onchange="loadCharacter(event)">
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <div class="tab-buttons">
                <button class="tab-btn active" onclick="switchTab('overview')">
                    üìÑ Overview
                </button>
                <button class="tab-btn" onclick="switchTab('combat')">
                    ‚öîÔ∏è Combat
                </button>
                <button class="tab-btn" onclick="switchTab('inventory')">
                    üéí Inventory
                </button>
            </div>
        </div>

        <!-- Content -->
        <div class="content">
            <!-- Overview Tab -->
            <div id="overview-tab">
                <div class="space-y-4">
                    <!-- Basic Info -->
                    <div class="grid grid-cols-4 gap-4">
                        <div>
                            <label class="label">Character Name:</label>
                            <input type="text" class="input" id="characterName" oninput="updateCharacter()">
                        </div>
                        <div>
                            <label class="label">Player Name:</label>
                            <input type="text" class="input" id="playerName" oninput="updateCharacter()">
                        </div>
                        <div>
                            <label class="label">Archetype:</label>
                            <input type="text" class="input" id="archetype" oninput="updateCharacter()">
                        </div>
                        <div>
                            <label class="label">Level:</label>
                            <input type="number" class="input" id="level" min="1" value="1" oninput="updateCharacter()">
                        </div>
                    </div>

                    <!-- Description and Physical -->
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="label">Description:</label>
                            <textarea class="textarea" id="description" rows="3" oninput="updateCharacter()"></textarea>
                        </div>
                        <div class="grid grid-cols-3 gap-2">
                            <div>
                                <label class="label">Height:</label>
                                <input type="text" class="input" id="height" oninput="updateCharacter()">
                            </div>
                            <div>
                                <label class="label">Weight:</label>
                                <input type="text" class="input" id="weight" oninput="updateCharacter()">
                            </div>
                            <div>
                                <label class="label">Size:</label>
                                <select class="select" id="size" onchange="updateCharacter()">
                                    <option>Tiny/-2</option>
                                    <option>Small/-1</option>
                                    <option selected>Medium/0</option>
                                    <option>Large/+1</option>
                                    <option>Huge/+2</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Attributes -->
                    <div class="grid grid-cols-2 gap-6">
                        <!-- Physical Attributes -->
                        <div>
                            <h3 class="section-title">üí™ Physical Attributes</h3>
                            <div class="grid grid-cols-2 gap-3">
                                <div class="attr-block">
                                    <div class="attr-header">
                                        <span class="font-semibold text-sm">STR:</span>
                                    </div>
                                    <div class="attr-inputs">
                                        <div class="flex-1">
                                            <label class="label-sm">Base</label>
                                            <input type="number" class="input" id="str-base" value="0" oninput="updateCharacter()">
                                        </div>
                                        <div class="flex-1">
                                            <label class="label-sm">Mods</label>
                                            <input type="number" class="input" id="str-mods" value="0" oninput="updateCharacter()">
                                        </div>
                                    </div>
                                    <div class="attr-total" id="str-total">0</div>
                                    <div class="text-xs text-center">Total</div>
                                </div>
                                
                                <div class="attr-block">
                                    <div class="attr-header">
                                        <span class="font-semibold text-sm">AGI:</span>
                                    </div>
                                    <div class="attr-inputs">
                                        <div class="flex-1">
                                            <label class="label-sm">Base</label>
                                            <input type="number" class="input" id="agi-base" value="0" oninput="updateCharacter()">
                                        </div>
                                        <div class="flex-1">
                                            <label class="label-sm">Mods</label>
                                            <input type="number" class="input" id="agi-mods" value="0" oninput="updateCharacter()">
                                        </div>
                                    </div>
                                    <div class="attr-total" id="agi-total">0</div>
                                    <div class="text-xs text-center">Total</div>
                                </div>
                                
                                <div class="attr-block">
                                    <div class="attr-header">
                                        <span class="font-semibold text-sm">DEX:</span>
                                    </div>
                                    <div class="attr-inputs">
                                        <div class="flex-1">
                                            <label class="label-sm">Base</label>
                                            <input type="number" class="input" id="dex-base" value="0" oninput="updateCharacter()">
                                        </div>
                                        <div class="flex-1">
                                            <label class="label-sm">Mods</label>
                                            <input type="number" class="input" id="dex-mods" value="0" oninput="updateCharacter()">
                                        </div>
                                    </div>
                                    <div class="attr-total" id="dex-total">0</div>
                                    <div class="text-xs text-center">Total</div>
                                </div>
                                
                                <div class="attr-block">
                                    <div class="attr-header">
                                        <span class="font-semibold text-sm">FORT:</span>
                                    </div>
                                    <div class="attr-inputs">
                                        <div class="flex-1">
                                            <label class="label-sm">Base</label>
                                            <input type="number" class="input" id="fort-base" value="0" oninput="updateCharacter()">
                                        </div>
                                        <div class="flex-1">
                                            <label class="label-sm">Mods</label>
                                            <input type="number" class="input" id="fort-mods" value="0" oninput="updateCharacter()">
                                        </div>
                                    </div>
                                    <div class="attr-total" id="fort-total">0</div>
                                    <div class="text-xs text-center">Total</div>
                                </div>
                            </div>
                        </div>

                        <!-- Mental Attributes -->
                        <div>
                            <h3 class="section-title">üß† Mental Attributes</h3>
                            <div class="grid grid-cols-2 gap-3">
                                <div class="attr-block">
                                    <div class="attr-header">
                                        <span class="font-semibold text-sm">KNO:</span>
                                    </div>
                                    <div class="attr-inputs">
                                        <div class="flex-1">
                                            <label class="label-sm">Base</label>
                                            <input type="number" class="input" id="kno-base" value="0" oninput="updateCharacter()">
                                        </div>
                                        <div class="flex-1">
                                            <label class="label-sm">Mods</label>
                                            <input type="number" class="input" id="kno-mods" value="0" oninput="updateCharacter()">
                                        </div>
                                    </div>
                                    <div class="attr-total" id="kno-total">0</div>
                                    <div class="text-xs text-center">Total</div>
                                </div>
                                
                                <div class="attr-block">
                                    <div class="attr-header">
                                        <span class="font-semibold text-sm">INS:</span>
                                    </div>
                                    <div class="attr-inputs">
                                        <div class="flex-1">
                                            <label class="label-sm">Base</label>
                                            <input type="number" class="input" id="ins-base" value="0" oninput="updateCharacter()">
                                        </div>
                                        <div class="flex-1">
                                            <label class="label-sm">Mods</label>
                                            <input type="number" class="input" id="ins-mods" value="0" oninput="updateCharacter()">
                                        </div>
                                    </div>
                                    <div class="attr-total" id="ins-total">0</div>
                                    <div class="text-xs text-center">Total</div>
                                </div>
                                
                                <div class="attr-block">
                                    <div class="attr-header">
                                        <span class="font-semibold text-sm">CHA:</span>
                                    </div>
                                    <div class="attr-inputs">
                                        <div class="flex-1">
                                            <label class="label-sm">Base</label>
                                            <input type="number" class="input" id="cha-base" value="0" oninput="updateCharacter()">
                                        </div>
                                        <div class="flex-1">
                                            <label class="label-sm">Mods</label>
                                            <input type="number" class="input" id="cha-mods" value="0" oninput="updateCharacter()">
                                        </div>
                                    </div>
                                    <div class="attr-total" id="cha-total">0</div>
                                    <div class="text-xs text-center">Total</div>
                                </div>
                                
                                <div class="attr-block">
                                    <div class="attr-header">
                                        <span class="font-semibold text-sm">WILL:</span>
                                    </div>
                                    <div class="attr-inputs">
                                        <div class="flex-1">
                                            <label class="label-sm">Base</label>
                                            <input type="number" class="input" id="will-base" value="0" oninput="updateCharacter()">
                                        </div>
                                        <div class="flex-1">
                                            <label class="label-sm">Mods</label>
                                            <input type="number" class="input" id="will-mods" value="0" oninput="updateCharacter()">
                                        </div>
                                    </div>
                                    <div class="attr-total" id="will-total">0</div>
                                    <div class="text-xs text-center">Total</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Character Features -->
                    <div>
                        <h3 class="section-title">Level Tracker / Character Features</h3>
                        <div class="space-y-3">
                            <div>
                                <label class="label">Level Tracker:</label>
                                <textarea class="textarea" id="levelTracker" rows="3" placeholder="Track level progression, abilities gained, etc." oninput="updateCharacter()"></textarea>
                            </div>
                            <div>
                                <label class="label">Character Features:</label>
                                <textarea class="textarea" id="characterFeatures" rows="5" placeholder="List traits, proficiencies, abilities, and other character features" oninput="updateCharacter()"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Combat Tab -->
            <div id="combat-tab" class="hidden">
                <div class="space-y-4">
                    <!-- Stats -->
                    <div>
                        <h3 class="section-title">üßÆ Stats</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <!-- Row 1: Initiative, Action Points -->
                            <div class="stat-block stat-yellow">
                                <div class="stat-label">Initiative</div>
                                <div class="stat-value" id="initiative-display">0</div>
                                <div class="stat-desc">AGI+DEX+INS</div>
                                <input type="number" class="input mt-1" id="initiative-mods" placeholder="Mods" oninput="updateCharacter()">
                            </div>
                            <div class="stat-block stat-green">
                                <div class="stat-label">Action Points</div>
                                <input type="number" class="input" id="action-points" value="4" oninput="updateCharacter()">
                                <div class="stat-desc">Base = 4</div>
                            </div>

                            <!-- Row 2: Speed (spans both columns) -->
                            <div class="stat-block stat-blue col-span-2">
                                <div class="stat-label">Speed</div>
                                <div class="flex gap-2">
                                    <div style="width: 80px;">
                                        <div class="label-sm">Ground</div>
                                        <div class="stat-value" id="speed-display">20</div>
                                    </div>
                                    <div class="flex-1">
                                        <div class="label-sm">Notes</div>
                                        <input type="text" class="input" id="speed-notes" placeholder="Other speeds (climb, swim, fly, etc.)" oninput="updateCharacter()">
                                    </div>
                                </div>
                            </div>

                            <!-- Row 3: Damage Reduction, Defense -->
                            <div class="stat-block stat-indigo">
                                <div class="stat-label">Damage Reduction</div>
                                <div class="stat-value" id="damage-reduction-display">0</div>
                                <input type="number" class="input mt-1" id="damage-reduction-mods" placeholder="Mods" oninput="updateCharacter()">
                            </div>
                            <div class="stat-block stat-red">
                                <div class="stat-label">Defense</div>
                                <div class="stat-value" id="defense-display">0</div>
                                <input type="number" class="input mt-1" id="current-defense" placeholder="Current" oninput="updateCharacter()">
                            </div>

                            <!-- Row 4: Vitality, Stress -->
                            <div class="stat-block stat-purple">
                                <div class="stat-label">Vitality</div>
                                <div class="stat-value" id="vitality-display">1</div>
                                <input type="number" class="input mt-1" id="current-vitality" placeholder="Current" oninput="updateCharacter()">
                            </div>
                            <div class="stat-block stat-red">
                                <div class="stat-label">Stress</div>
                                <div class="flex gap-2">
                                    <div class="flex-1">
                                        <div class="label-sm">Threshold</div>
                                        <div class="stat-value" id="stress-threshold-display">1</div>
                                    </div>
                                    <div class="flex-1">
                                        <div class="label-sm">Current</div>
                                        <input type="number" class="input" id="current-stress" oninput="updateCharacter()">
                                    </div>
                                </div>
                            </div>

                            <!-- Row 5: Luck, Grapple -->
                            <div class="stat-block stat-yellow">
                                <div class="stat-label">Luck</div>
                                <div class="flex gap-2">
                                    <div class="flex-1">
                                        <div class="label-sm">Max</div>
                                        <input type="number" class="input" id="max-luck" value="5" oninput="updateCharacter()">
                                    </div>
                                    <div class="flex-1">
                                        <div class="label-sm">Current</div>
                                        <input type="number" class="input" id="current-luck" value="5" oninput="updateCharacter()">
                                    </div>
                                </div>
                            </div>
                            <div class="stat-block stat-orange">
                                <div class="stat-label">Grapple</div>
                                <div class="stat-value" id="grapple-display">0</div>
                                <div class="stat-desc">STR+AGI</div>
                            </div>

                            <!-- Row 6: Stealth, Custom -->
                            <div class="stat-block stat-gray">
                                <div class="stat-label">Stealth</div>
                                <input type="text" class="input" id="stealth" placeholder="Varies" oninput="updateCharacter()">
                            </div>
                            <div class="stat-block stat-gray">
                                <div class="stat-label">Custom</div>
                                <input type="text" class="input" id="custom" placeholder="Custom">
                            </div>
                        </div>
                    </div>

                    <!-- Equipment -->
                    <div class="grid grid-cols-2 gap-6">
                        <!-- Offensive Equipment -->
                        <div>
                            <h3 class="section-title">‚öîÔ∏è Offensive Equipment</h3>
                            <div id="weapons-container">
                                <!-- Weapons will be generated by JavaScript -->
                            </div>
                        </div>

                        <!-- Defensive Equipment -->
                        <div>
                            <h3 class="section-title">üõ°Ô∏è Defensive Equipment</h3>
                            <div class="space-y-3">
                                <div class="equipment-block">
                                    <h4 class="font-semibold mb-2">Armor</h4>
                                    <input type="text" class="input mb-2" id="armor-name" placeholder="Armor name" oninput="updateCharacter()">
                                    <div class="grid grid-cols-2 gap-2 mb-2">